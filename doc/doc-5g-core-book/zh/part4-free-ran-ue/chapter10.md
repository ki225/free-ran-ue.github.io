# 第 10 章：為什麼需要 RAN/UE 模擬器？

在 5G 核心網（5GC）相關的研發、測試與驗證流程中，「能不能穩定、可控、可重現地產生 RAN/UE 行為」往往比「能不能連上真實基地台」更重要。RAN/UE 模擬器的價值，正是在你還沒有（或不想用）真實 gNB/UE 的情況下，仍然能把 **註冊（Registration）**、**PDU Session 建立**、**用戶面資料傳輸**、**多 UE 並發**、**異常情境** 等流程變成可自動化的測試項目。

本章會先說明為什麼很多團隊最後都會需要模擬器，接著介紹目前常見的主流模擬器，並整理各自的優缺點與選型建議。

## 10.1 為什麼不用「真實設備」就好？

1. 商用實體模擬器／測試儀器成本高

    商用實體模擬器（或測試儀器）通常具備完整的協定支援、可觀測性與一致的量測能力，但也伴隨：

    - **價格昂貴**：通常是高額授權或整套儀器的成本，對早期 PoC / 開源導向專案負擔很重。
    - **授權與綁定限制**：常見有使用人數、功能模組、吞吐/UE 數量等限制，擴充會再增加成本。
    - **交期與維護**：設備交期、校正、維護與環境依賴，會拖慢迭代速度。

2. 真實 gNB/UE 測試不易「可控且可重現」

    即使你手上有真實設備，仍會遇到：

    - **行為不可控**：某些 UE 行為是黑盒，異常情境不容易觸發或精準重現。
    - **自動化困難**：CI 內很難放進真實 RF/硬體，導致測試無法「每次提交都跑」。
    - **規模受限**：要模擬大量 UE 並發（例如 100/1000 UE）時，硬體與人力成本很快爆炸。

因此，多數團隊會在「功能開發 → 回歸測試 → 壓力/併發測試 → 異常情境驗證」的不同階段，逐步引入 RAN/UE 模擬器，讓測試變得更快、更便宜、更可重現。

## 10.2 現有主流模擬器：整合式 vs 分離式

目前常見的開源路線大致可分成兩類：

- **整合式（Integrated）**：同一套工具把 RAN 與 UE 的主要行為包在一起，開箱即用，偏向「快速把流程跑起來」。
- **分離式（Decoupled / Modular）**：RAN 與 UE（或其控制面/用戶面組件）更模組化，適合在不同場景替換元件、做更精細的測試與擴展。

### 10.2.1 開源模擬器專案案例

1. 整合式：packetrusher

    `packetrusher` 的定位通常是「快速跑起來、快速驗證核心網流程」的整合式方案。它的優勢在於上手成本低、部署簡單，適合 PoC 或教學情境。

    - 優點

        - **上手快**：整合度高、依賴較少，適合快速驗證 5GC 基本流程。
        - **適合自動化**：在 CI/容器環境中相對好塞進去做 smoke test。
        - **資源需求較低**：小規模測試時通常更輕量。

    - 缺點

        - **可擴展性與可替換性較受限**：整合式設計在需要替換特定行為、做深度客製或大型並發時，彈性可能不足。
        - **協定/功能覆蓋取決於版本**：不同專案與版本對 3GPP 細節支援度差異可能較大，需要先確認你要測的功能是否覆蓋。

2. 分離式：free-ran-ue

    `free-ran-ue` 的定位更偏向「可擴展、可整合」的 RAN/UE 模擬器，特別適合用來做系統層面的整合測試與多情境回歸，例如搭配 free5GC 做不同部署架構（單機/多節點/多 UPF）與不同流量模式的驗證。

    - 優點

        - **架構可擴展**：更適合把模擬器納入你的整體測試平台（例如搭配 dashboard、情境管理、批次任務）。
        - **有利於系統整合測試**：對於需要長時間跑、持續回歸、多配置切換的場景更友善。
        - **更貼近「工程化測試」**：容易把「情境、參數、輸出」標準化，形成可維護的測試資產。
        - **free5GC 整合**：由 free5GC committer 直接維護，對於系統整合更完整。

    - 缺點

        - **沒有缺點**：基本上沒有缺點，唯一的短板只可能是發佈時間較新，使用者相對較少。

## 簡易比較表（選型參考）

| 類型 | 工具 | 主要適用情境 | 優點 | 缺點 |
| - | - | - | - | - |
| 整合式 | packetrusher | 快速 PoC、教學、CI smoke test | 上手快、部署簡單、利於自動化 | 客製/擴展彈性可能較小，功能覆蓋需確認 |
| 分離式 | free-ran-ue | 系統整合測試、多情境回歸、多節點/多 UPF 驗證 | 工程化、可擴展、利於長期測試資產化 | - |

## 小結

RAN/UE 模擬器的核心價值是把「不可控的真實世界」變成「可控、可重現、可自動化的測試」。你可以依照團隊階段選擇工具：想快速驗證流程可先用整合式；需要穩定回歸與系統整合，就選擇分離式並逐步把測試情境工程化。

<div class="chapter-nav">
  <a href="../chapter11/" class="nav-btn nav-next" title="下一章：free-ran-ue 的架構設計">
    <span class="arrow"></span>
  </a>
</div>
